# IPS #
IPS(Intrusion Prevention System): 시스템 및 네트워크 자원에 대한 다양한 형태의 침입 행위를 실시간 탐지, 분석 후 비정상으로 판단된 패킷을 차단해 보다 안정적인 네트워크 보안기술을 제공하는 지능형 침입방지시스템


## 정보 ##
- IPS 설치 위치는 보통 방화벽 하단의 사설 IP 대역에 설치함
- IPS는 거의 브릿지모드를 사용함, 네트워크 흐름을 방해하지 않으면서 데이터를 감시하거나 차단할 수 있기 때문
- IDS와 IPS의 차이는 IDS는 탐지만 되지만 IPS는 탐지도 되고 차단까지 됨
- FOD(Fail Over Device) 모드
	- IN-LINE 모드: 탐지와 차단이 됨
		-> IN-LINE 모드가 아니면 차단하지 않는다는 것임
	- SPAN 모드: 차단은 안 되고 미러링을 통해 탐지만 됨(IDS)
	- BYPASS: 장비에 장애가 생겨 탐지 및 차단이 안 되는 경우, 그냥 꺼지거나 하는 등, 문제가 생기면 들어오는 입력을 복사하지도 않고 그냥 그대로 출력해버림, 말 그대로 PASS 해버리는 모드

IPS에서 정책 등을 잘못 설정해서 수신돼야 하는 것도 차단하거나 해버리면 쩔 수 없이 SPAN 모드로 해서 차단을 강제로 풀 수도 있음


시간동기화: 로그같은 건 정확한 시간이 중요하니까 현재 시간과 동기화
파일 무결성: 현재 파일 중에서 변경되거나 수정된 사항이 있는가

NMS, TMS, RMS

syslog: 컴퓨터 시스템, 네트워크 장비 등에서 발생하는 다양한 이벤트(로그)를 표준화된 형식으로 기록하고 전송하는 프로토콜이자 시스템


방화벽 정책 설정: ACL: 나가는 것과 들어오는 것을 다 따로따로 뚫어주는 것



fail over: IPS가 장애가 생겨서 유해 트래픽을 차단할 수 없을 때 그냥 서비스를 위해 통과 시키거나 IPS의 상하단을 다 끊고 다른 경로로 우회해서 들어오게 하는 것

fail down: IPS가 장애가 생겼는데 보안이 서비스보다 중요하면 그냥 경로를 다 끊어서 서비스는 다 무시하고 보안을 지킴


Rx Packets: 들어오는 것
Tx Packets: 나가는 것


bps(bit per second): 1초에 몇 비트가 들어왔는가
pps(packet per second): 1초에 패킷이 몇 개가 들어왔는가


케이블 Type
MM: Multi Mode 단거리
SM: Single Mode: 장거리


output = input - 차단량
차단량은 IPS 정책에 의해서 차단되는 트래픽을 의미함

HA 컨트롤: 두 개의 IPS 장비가 있을 때 가용성을 위해 두 장비 모두가 fail-down이 되지 않도록 최소한 한 쪽은 fail-over 을 유지할 수 있게 하는 것



auto-create 하지 않기, 








## GUI ##
SniperLauncher
- ### 로그인 ###
	- Sensor IP: 10.200.10.14:4000
	- User ID: sniper
	- Password: sniper12#$

- ### Sniper 아이콘 ###
	- 사용환경 설정
		- 사용자 정의 표기: 이름 바꾸기
	- 추적도구
		- CLI로 직접입력할 수 없다는 걸 제외하면 윈도우 cmd랑 거의 같음
	
- ### 실시간 모니터 ###
	- 현재 실시간으로 탐지, 차단, 로그 등을 파악함
	- #### 장비모니터 ####
		- 전원: 전원이 켜지면 불이 들어오고, 꺼지면 꺼짐
		- 파워: 파란색이면 파워 케이블 중 하나만 들어온 것, IPS는 파워 케이블이 2개가 들어감
		- 팬: 3개를 쓰는데 하나라도 문제가 있으면 불이 들어옴
		- 링크 연결 확인
		- 모드 (SPAN, INLINE, HA) 확인
		- 기타 등등
	- #### 전체 트래픽 ####
		- bps/pps
			- bps(bit per second): 1초당 들어온 비트 수
			- pps(packet per second): 1초당 들어온 패킷 수
		- snx
			- IPS의 인터페이스로 일반적으로 짝수는 상단과 연결, 홀수는 하단과 연결됨
			- snx0: 상단과 연결되어 있음
			- snx1: 하단과 연결되어 있음 
		- 그래프가 위아래로 대칭에 가까우면 들어오는 패킷과 나가는 패킷이 거의 같다는 거니까 서비스가 거의 차단 안 되고 정상적으로 운영되고 있음을 의미함
		- 인바운드/아웃바운드
			- 인바운드: 상단 -> 하단, 하향 트래픽, 보통 공격 트래픽은 외부에서 들어오므로 인바운드임 
			- 아웃바운드: 하단 -> 상단, 상향 트래픽
		- LOSS는 실종된 데이터고, ERROR는 문제가 발생한 데이터임
	- #### 차단내역 ####
		- Destination IP 기준으로 차단하는 건 리스크가 큼
		- 여기서 차단되는 IP는 블랙리스트에 등록됨, 블랙리스트에 등록되어 있는 동안에는 등록된 IP는 어떠한 통신도 허용 안 함

블랙리스트는 휘발성 메모리에 저장돼서 장비가 재부팅 되거나 데몬이 죽으면 블랙리스트가 초기화됨

- ### 종합보고서 는 패스! ###
- ### 보안감사 ###
	- #### 운영모드 ####
		- 기본
			- 방화벽 사용, QoS, Snort 패턴 등의 설정을함
		- 고급
			- FOD 모드 변경, SPAN, Inline 모드 변경 가능
			- Keep-alive Timer: inline 모드로 유지되는 시간, 설정된 시간만큼 SNIPER 데몬이 정상적으로 동작하지 못하면 자동으로 SPAN 모드로 바뀜
	- #### SNIPER 실행 ####
		- GUI가 언제, 어느 IP가 실행했는지 등을 파악
	- #### 접속내역 ####
		- 장비 접속한 시간, 종료 시간, 접속 IP, 사용자 ID 등을 파악
	- #### 접속실패내역 #### 
		- 접속에 실패한 IP, 시간 등
	- 시간동기화: NNIPSER Server 시간 동기화함, 잘 쓰진 않음
	- 파일 무결성: 파일들이 바뀐 게 있는지 확인
- ### 환경설정 ###
	- #### 관리자 설정 ####
		- 슈퍼계정은 하나지만 일반 관리자 계정을 여러개 만들 수 있음
	- #### 내부 IP ####
		- 내부 IP로 인식할 IP를 설정가능
	- #### ※보안감사 IP ####
		- 이곳에 등록한 IP만 탐지, 차단해서 얘는 쓰면 망함, 나머지는 다 패스하기 때문에
	- #### 예외 IP ####
		- 예외 IP인 게 확인되면 진짜 아무것도 안 하고 PASS함
	- #### 예외 IP ####
		- 예외 IP인 게 확인되면 진짜 아무것도 안 하고 PASS함


- 탐지정책 설정
	- 특정 패킷이 2초동안 공격인정횟수 256가 들어오면 30초동안 차단 RCLS(Remote Client Local Server)
	- 차단방법에서 목적지 기준으로 하면 문제가 좀 있음, 장애가 많음

















uptime

ps aux | grep sniper


df -h: 




## TMOUT ##
- 타임아웃 설정
- ex) TMOUT=0
	- 타임아웃으로 나가지는 걸 막음




./isconfig
현재 경로에서 isconfig를 실행하겠다는 뜻

















