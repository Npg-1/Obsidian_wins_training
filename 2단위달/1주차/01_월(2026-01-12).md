



Scapy: 파이썬으로 작성된 네트워크 패킷 조작 도구로 패킷을 직접 생성(Forge), 전송(Send), 가로채기(Sniff), 분석(Analyze) 등을 할 수 있는 기능을 제공함



## IP기반 차단 & 패킷 기반 차단 ##
IP 기반 차단과 패킷 기반 차단을 GUI 에서 구현하는 방법은 탐지 정책 설정에서 제한 시간을 0으로 하면 패킷 기반 차단이 되고, 1이상으로 하면 IP 기반 차단이 됨
![[Pasted image 20260112172720.png]]

![[Pasted image 20260112172741.png]]

탐지 정책 설정에서 공격인정횟수/공격인정시간/제한시간을 합쳐서 설명하면 (공격인정시간) 동안에 (공격인정횟수)만큼의 공격이 들어오면 (제한시간)만큼 블랙리스트에 공격자의 **IP**를 올려서 공격을 차단하는 것

제한시간이 1이상이면 IP 기반 차단이 되고, 제한시간이 0이면 패킷 기반 차단임

### IP기반 차단 ###
- IP 기반 차단은 처음에 어떤 공격이든 공격인정횟수 만큼은 공격을 허용하고 그 뒤에 블랙리스트에 올리기 때문에 최소한 1번은 공격을 허용할 수 밖에 없음
- 블랙리스트에 올라간 공격자의 IP 자체를 차단하기 때문에 공격자가 공격이 아닌 일반 패킷을 보내더라도 해당 패킷이 공격 패킷인지 판단하지 않고 무조건 차단하기 때문에 정확성이 부족해짐

### 패킷 기반 차단 ###
- 패킷 기반 차단은 제한시간이 0이 돼서 차단 정책에서 작성한 패턴(예: 탐지문자열)에 해당하는 패킷은 원천차단함.
- IP 패킷과는 달리 공격인정횟수에 상관없이 차단 패턴에 해당하는 패킷은 무조건 차단하기 때문에 패턴을 잘 작성해야함
- 제한시간이 없기 때문에 차단하는 패킷은 따로 블랙리스트에 올라가지 않고 무조건 차단함

IP/패킷 기반 차단의 공통점으로는 둘 다 차단은 하더라도 탐지내역에는 올라감
 


![[Pasted image 20260112172505.png]]





오늘 했던 내용 중에서 강사님이 보내는 패킷을 차단정책을 짜서 차단하는 내용이 있었음
차단 정책에서 Flow는 Request/Response 가 있는데 뜻은 각각 요청/응답으로 이번에는 Response 였음
왜냐하면 강사님이 보내는 패킷이 우리가 보낸 요청에 대한 응답이기 때문에 응답을 차단하기 위해서 Response를 Flow에서 설정함(?)
(솔직히 맞는지 잘 모르겠음, 이건 좀 알아볼 필요가 있어보임)

아니면 내일 강사님한테 직접 물어보거나























1. WinsCP 에서 10.200.10.11:222(root/sniper!#@$)로 접속해서 /backup/IPS scapy.txt 가져오기
2. IPS scapy.txt 에서 IP(src="172.16.255.100", dst="175.207.112.200") -> IP(src="172.16.255.100", dst="10.100.4.3") 바꾸기



CUI: 10.200.10.4 (222), root/sniper!#@$
GUI: sniper/sniper12#


토마호크 (패킷발생기)
10.100.4.104 : 22
CLI: wins21 / 보안00!#@$


sudo su -> 보안00!#@$ 입력
TMOUT = 0
scapy
conf.iface="eth4"


GUI(자기 조) -> 탐지정책 설정 -> 사용자 정의 -> 우클릭 -> 패턴 추가 -> 김정우/LSRS, LCLS 체크 탐지 문자열: KimJungWoo, 공격자, 대상자 축약: 32
실시간 모니터 -> 탐지 내역 -> UDP-Source IP Flooding 와 같은 뜨는-> 탐지 정책 설정 -> 탐지 X


IPS scapy -> aaaa -> KimJungWoo



사용자 정의 패턴 변경 -> RAW 데이터


정책 변경 -> 시간:0, 방어 체크



김미지02	최원석	강민우01		송소현00	유승원	안성민04	
우승철	안경철01	류태욱		강순우01	이재영	정주연	
		김정우00	이아정98		박래욱	최준석	박민호	
		박민혁				고권률	임형근			








