# 개념 #
- Dockerfile
	- 도커 이미지를 생성하기 위한 지시사항들을 포함하는 텍스트 파일
	- 사용하면 도커 이미지를 구성하는 과정을 자동화하고, 이미지가 어떻게 빌드되어야 하는지 세부사항을 정의할 수 있다
	- 이미지 빌드를 반복 가능하게 한다
	- 버전관리 시스템을 통해 이미지 구성을 관리하기 편하다
- Dockerfile build
	- 이미지를 빌드하는데 필요한 모든 설정과 단계를 하나의 파일에 정의하므로, 이미지의 구성을 쉽게 유지보수 할 수 있다
	- 버전관리 시스템을 통해 관리가 가능하다





# docker-compose.yml 분석 #
- ## command ##
	- 컨테이너의 기본 명령어를 덮어쓰기(override) 위한 명령어
	
- ## image ##
	- 컨테이너를 생성할 때 사용할 Docker 이미지를 지정
	- 로컬에 이미지가 없다면 온라인에서 자동으로 다운로드함
		- ex) image: mysql:8.0

- ## container_name ##
	- 컨테이너의 이름 지정
	- 지정 안 하면 도커가 자동으로 지정함(예: project_A_1), 이름을 지정하면 **docker ps** 같은 명령어로 식별이 편함
		- ex) container_name: my-web-server

- ## environment ##
	- 컨테이너 환경변수 설정
	- 데이터베이스의 비밀번호, API 키, 서버 모드 등 애플리케이션 설정값을 지정
		- ex) 
			environment:
				\- DB_PASSWORD=secret123
				\- APP_COLOR=blue

- ## ports ##
	- 호스트(내 컴퓨터)와 컨테이너 간의 포트 연결을 설정
	- \[외부포트]:\[내부포트] 형식으로 작성해서 외부에서 컨테이너로 접속할 수 있게함
		- ex)  ports: "8080:80" -> 내 컴퓨터의 8080으로 접속하면 컨테이너의 80으로 연결됨

- ## networks ##
	- 컨테이너가 접속할 네트워크를 지정
	- 여러 개의 컨테이너가 서로 통신해야 할 때, 동일한 네트워크 이름 안에 묶어두면 서비스 이름으로 서로를 찾을 수 있음
		- ex)  networks: - backend-network

- ## volumes ##
	- **데이터 볼륨**을 설정합니다. (호스트와 컨테이너의 디렉토리 공유)
	- 컨테이너는 삭제되면 내부 데이터도 사라짐. 데이터를 영구적으로 보존하거나, 호스트의 소스 코드를 실시간으로 컨테이너에 반영하고 싶을 때 사용
		- ex)  volumes: /my/host/data:/var/lib/mysql

- ## depends_on ##
	- 서비스 간의 실행 순서(의존성)를 정의
	- 예를 들어 웹 서버(A)가 실행되기 전에 데이터베이스(B)가 먼저 실행되어야 한다면 이 설정을 사용
		- ex)  depends_on: db-service

- ## user ##
	- 컨테이너를 생성할 때 사용할 Docker 이미지를 지정
		- ex)  ports: "8080:80" -> 내 컴퓨터의 8080으로 접속하면 컨테이너의 80으로 연결됨





# 명령어 #

## build ##
- 새로운 이미지를 만드는 것
	- ex) docker build -t my-app1.0 . : 현재 폴더이 있는 'Dockerfile'을 사용해서 이미지를 만듦, 마지막의 . 은 현재 경로를 뜻함


## compose ##
- 여러 개의 컨테이너를 정의하고 관리하는 도구인 '도커 컴포즈'를 사용하겠다는 명령어
	- ex) docker compose up -d
		- up: 설정 파일(예: docker-compose.yml)에 적힌 대로 이미지를 다운로드하고 컨테이너 생성 및 실행하라는 명령어(옵션이 아니라 명령어임)
		- -d(Detached mode): 백그라운드 실행 모드

## exec/exit ##
- 실행중인 컨테이너 내부로 접속 및 종료
	- ex) docker exec -it attacker_container /bin/bash: attacker_container로 접속함(컨테이너 외부 입력)
	- ex) exit: 컨테이너를 종료하고 나오게 빠져나옴
		- <-> 단축키로 Ctrl + P + Q를 누르게 되면 컨테이너는 백그라운드에서 실행중인 상태로 컨테이너를 빠져나오게됨, 다시 들어가려면 exec 명령어를 사용하면 됨


## ps ##
- 현재 어떤 컨테이너가 실행 중인지, 혹은 멈춰 있는지 확인하는 명령어 
	- ex) docker ps: 현재 실행중인 컨테이너만 확인
	- ex) docker ps -a: 정지된 것을 포함한 모든 컨테이너 확인


## rename ##
- 도커 컨테이너의 이름 변경
	- ex) docker rename attacker-container attacker_container


## rm ##
- 컨테이너 삭제
	- ex) docker rm attacker_container: attacker_container 삭제


## run ##
-  새로운 컨테이너의 생성 및 실행
	- ex) docker run -it --name attacker-container ubuntu:20.04 /bin/bash
		- -it: 도커 컨테이너에서 내 컴퓨터 터미널과 같이 터미널 입력을 할 수 있게 지정
			- - i(interactive): 컨테이너와 표준 입력을 유지
			- -t(tty, 리눅스에서 터미널을 나타냄): 터미널 환경을 할당
		- -- name attacker_container: 컨테이너의 이름을 attacker_container로 지정
		- ubuntu:20.04: 컨테이너의 기반이 될 **이미지**로 우분투 20.04 버전 환경을 빌려옴
		- /bin/bash: 컨테이너가 켜지자마자 실핼할 프로그램, 이 예시에서는 배시 쉘(Bash Shell)을 실행해서 명령어를 입력함


## start/stop ##
- 컨테이너 시작 및 종료
	- ex) docker start attacker_container: attacker_container 시작
	- ex) docker stop attacker_container: attacker_container 종료






